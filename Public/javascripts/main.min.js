const SessionKey={searchResults:"com.swiftpackageindex.searchResults"};function performSearch(e){const t="/api/search?query="+e;clearSearchResults(),axios.get(t).then((function(e){sessionStorage.setSerializedItem(SessionKey.searchResults,e.data),displaySearchResults(e.data),window.searchResultSelectedIndex=null})).catch((function(e){console.error(e),displayErrorMessage(e)})),setElementHiddenById("results",!1)}function clearSearchResults(){const e=document.getElementById("results");if(e)for(;e.lastElementChild;)e.removeChild(e.lastElementChild)}function displaySearchResults(e){const t=document.getElementById("results");if(!t)return;const n=e.results.length;if(n<=0){const e=document.createElement("p");e.textContent="No Results. Try another search?",e.classList.add("no_results"),t.appendChild(e)}else{const s=document.createElement("ul");if(e.results.forEach((e,t)=>{createSearchResultListItemElement(e,s)}),t.appendChild(s),e.hasMoreResults){const e=document.createElement("p");e.textContent=`More than ${n} results match this query. Try a more specific search.`,e.classList.add("more_results"),t.appendChild(e)}}}function displayErrorMessage(e){const t=document.getElementById("results");if(!t)return;const n=document.createElement("div");n.classList.add("error"),t.appendChild(n);const s=document.createElement("i");s.classList.add("icon"),s.classList.add("warning"),n.appendChild(s);const r=document.createElement("h4");r.textContent="Something went wrong. Sorry!",n.appendChild(r);const a=document.createElement("p");n.appendChild(a),e.response?(a.textContent=e.response.status+" – "+e.response.statusText,e.response.data&&e.response.data.reason&&e.response.data.reason!=e.response.statusText&&(a.textContent+=" – "+e.response.data.reason)):a.textContent="Unexpected Error."}function setElementHiddenById(e,t){const n=document.getElementById(e);n&&(n.hidden=t)}function createSearchResultListItemElement(e,t){const n=document.createElement("li"),s=document.createElement("a");s.href="/packages/"+e.id,n.appendChild(s);const r=document.createElement("div");s.appendChild(r);const a=document.createElement("h4");a.textContent=e.name,r.appendChild(a);const o=document.createElement("small");o.textContent=e.owner+"/"+e.package_name,r.appendChild(o);const d=document.createElement("p");d.textContent=e.summary,s.appendChild(d),t.appendChild(n)}document.addEventListener("DOMContentLoaded",(function(e){document.addEventListener("click",(function(e){var t=e.target;do{"a"==t.nodeName.toLowerCase()&&t.hostname!=window.location.hostname&&t.setAttribute("target","_blank")}while(t=t.parentElement)}));const t=document.getElementById("query");t&&(t.addEventListener("input",_.debounce((function(e){const t=e.target.value.trim();t.length>0?performSearch(t):setElementHiddenById("results",!0)})),200),t.addEventListener("keydown",(function(e){13==e.keyCode&&e.preventDefault();const t=document.getElementById("results");if(!t)return;const n=t.querySelector("ul");if(!n)return;if(e.target.value.length<=0)return;const s=sessionStorage.getDeserializedItem(SessionKey.searchResults);switch(e.keyCode){case 13:n.children[window.searchResultSelectedIndex].querySelector("a").click();break;case 38:"number"!=typeof window.searchResultSelectedIndex?window.searchResultSelectedIndex=s.results.length-1:window.searchResultSelectedIndex=Math.max(window.searchResultSelectedIndex-1,0);break;case 40:"number"!=typeof window.searchResultSelectedIndex?window.searchResultSelectedIndex=0:window.searchResultSelectedIndex=Math.min(window.searchResultSelectedIndex+1,s.results.length-1)}Array.from(n.children).forEach((function(e,n){n==window.searchResultSelectedIndex?(e.classList.add("selected"),window.searchResultSelectedIndex==s.results.length-1?t.scrollTop=t.scrollHeight:e.scrollIntoViewIfNeeded(!1)):e.classList.remove("selected")}))})))})),window.addEventListener("pageshow",(function(e){const t=document.getElementById("query");if(t){if(t.value.trim().length>0){const e=sessionStorage.getDeserializedItem(SessionKey.searchResults);e&&(clearSearchResults(),displaySearchResults(e))}else setElementHiddenById("results",!0)}})),Storage.prototype.getDeserializedItem=function(e){const t=this.getItem(e);return t?JSON.parse(t):null},Storage.prototype.setSerializedItem=function(e,t){this.setItem(e,JSON.stringify(t))};
//# sourceMappingURL=main.min.js.map